<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat UI with Bootstrap 5</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <style>
        .back {
            /* width: 1rem; */
            /* height: 1rem; */
        }

        /* 채팅방 전체 */
        .chat-container {
            max-width: 100%;
            margin: 0 auto;
            height: 100vh;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
        }

        /* 채팅방 해더 */
        .chat-header {
            padding: 1rem;
            background-color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-body {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background-color: #ffffff;
        }

        .chat-footer {
            padding: 1rem;
            background-color: #f8f9fa;
        }

        .npc {
            margin-bottom: 10px;
        }

        /*부엉이 채팅*/
        .npc-message {
            display: flex;
            justify-content: start;
        }

        /* 부엉이 채팅 초록 박스 */
        .npc-message-box {
            /* width: 40%; */
            display: inline;
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 1rem;
            border-top-left-radius: 0px;
            background-color: white;
            /* box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); */
            background-color: rgba(195, 233, 145, 0.34);
        }

        /* 채팅 전송자 폰트 */
        .npc-message-box .message-sender {
            font-weight: bold;
        }

        /* 채팅 내용 */
        .npc-message-box .message-text {
            margin-top: 0.5rem;
        }

        /* 스토리텔링 옵션 */
        .npc-options {
            /* width: 50%; */
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
        }

        .npc-option {
            /* width: 100px; */
            width: 100%;
            margin: 0 20px;
            background-color: rgba(223, 204, 116, 0.3);
            border-color: #ffb605;
            color: black;
            border-radius: 10px;
        }

        .npc-option:hover {
            background-color: #ffb605;
        }

        .divider {
            width: 100%;
            height: 1px;
            background-color: #ccc;
            margin: 0.5rem 0;
        }

        .sent-message {
            display: flex;
            justify-content: end;
        }

        .sent-message-box {
            display: inline;
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 1rem;
            background-color: #b8ea76;
            border-top-right-radius: 0px;
        }
    </style>
</head>

<body>
    <div class="chat-container">
        <!-- 헤더 -->
        <div class="chat-header">
            <!-- 백 버튼 -->
            <div class="btn back" onclick="goBack()">
                <svg width="10" height="19" viewBox="0 0 10 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M0.24346 10.3038C-0.0811533 9.96605 -0.0811533 9.42045 0.24346 9.08186L7.94761 1.05925C8.41622 0.570664 9.17865 0.570664 9.64809 1.05925C10.1167 1.54783 10.1167 2.3408 9.64809 2.82938L3.05761 9.69325L9.64809 16.5554C10.1167 17.0448 10.1167 17.8378 9.64809 18.3264C9.17865 18.815 8.41622 18.815 7.94761 18.3264L0.24346 10.3038Z"
                        fill="black" />
                </svg>
            </div>
            <!-- 홈버튼 -->
            <div class="btn" onclick="goHome()">
                <svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M9 0L18 8.85371L17.1818 9.65859L15.9425 8.43942V14.8618L15.9425 16H2.0575V14.8618V14.8617V8.43942L0.818182 9.65859L0 8.85371L8.18182 0.804881L9 0ZM9 1.60976L14.7854 7.30114V14.8617H11.3142V10.3087H10.1571V14.8617H7.84292V10.3087H6.68583V14.8617H3.21458V7.30114L9 1.60976ZM11.3142 9.17037H6.68583V10.3087H11.3142V9.17037Z"
                        fill="black" fill-opacity="0.8" />
                </svg>
            </div>
        </div>

        <div class="divider"></div>

        <!-- 채팅방 전체 -->
        <div class="chat-body" id="chat-body">
            <!-- 부엉이 npc -->
            <div class="npc">
                <!-- npc 메시지 -->
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">안녕! 난 너에게 이야기를 해줄 부엉이 선생님이야!
                            어떤 인물의 이야기를 듣고 싶어?
                        </div>
                    </div>
                </div>
                <!-- npc 채팅 옵션 -->
                <div class="npc-options rounded">
                    <div class="btn npc-option" onclick="selectOptionByUser('선덕여왕'); whatdoyouwanttoknow('선덕여왕');">
                        선덕여왕
                    </div>
                    <div class="btn npc-option" onclick="selectOptionByUser('세종대왕'); whatdoyouwanttoknow('세종대왕');">
                        세종대왕
                    </div>
                    <div class="btn npc-option" onclick="selectOptionByUser('안중근'); whatdoyouwanttoknow('안중근');">
                        안중근
                    </div>
                </div>
            </div>
            <!-- 옵션 클릭 사용자 메시지 -->
            <div class="sent-message">
                <img src="" alt="" />
                <div class="sent-message-box d-none">
                    <div class="message-sender text-end">You</div>
                    <div class="message-text"></div>
                </div>
            </div>
        </div>
        <!-- <div class="chat-footer">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Type a message">
                <button class="btn btn-primary" type="button">Send</button>
            </div>
        </div> -->
    </div>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        function goBack() {
            window.history.back();
        }

        function goHome() {
            window.location.href = '/';
        }
        // 기본 정보
        let sejongInfo = '세종은 똑똑했어'
        let sundukInfo = '선덕은 예뻤어'
        let ahnInfo = '안중근은 멋졌어'

        // 업적 정보
        sejong_job_list = [
            '평화로운 유교 정치',
            '책을 만드는 집현전',
            '훈민정음, 한글의 탄생',
            '눈부신 과학기술의 발전',
            '음악, 아악',]
        sunduk_job_list = [
            '백성들을 위한 따뜻한 마음',
            '나라를 지키는 상징, 구층목탑',
            '위기와 죽음',]
        ahn_job_list = [
            '독립을 위한 망명과 활동',
            '일본의 압박과 을사늑약',
            '항일 의병 투쟁',
            '이토 히로부미 저격',
            '의연한 재판과 순국',
        ]
        // 업적 답변
        sejong_job_answer = {
            '평화로운 유교 정치': "세종대왕은 유교적 이념을 바탕으로 중앙집권적 통치체제를 강화하고, 백성을 위한 정치와 사회 제도를 개선하였습니다. 특히, 경국대전의 초안을 작성하여 법제도를 정비하고 유교 교육을 강화하였습니다.",
            '책을 만드는 집현전': "세종대왕은 집현전을 설립하여 학문과 문화를 진흥시켰습니다. 집현전은 학자들이 모여 연구하고 토론하며 다양한 분야에서 지식을 쌓는 중요한 기관이었습니다. 이를 통해 한글 창제와 같은 중요한 성과를 이루어냈습니다.",
            '훈민정음, 한글의 탄생': "세종대왕은 백성들이 쉽게 읽고 쓸 수 있는 한글, 즉 훈민정음을 창제하였습니다. 이는 한국 역사상 가장 중요한 문화적 업적으로 평가되며, 오늘날까지도 사용되고 있는 한국어의 기초가 되었습니다.",
            '눈부신 과학기술의 발전': "세종대왕은 과학기술의 발전에도 큰 관심을 기울였습니다. 천문학, 의학, 농업 등의 분야에서 많은 발전이 이루어졌으며, 측우기, 앙부일구 등 다양한 과학기구를 발명하였습니다.",
            '음악, 아악': "세종대왕은 음악에도 깊은 관심을 가지고 새로운 악기와 악곡을 창작하였습니다. 특히, 아악을 정비하고 궁중음악을 체계화하여 음악 문화의 발전에 크게 기여하였습니다."
        }
        sunduk_job_answer = {
            '백성들을 위한 따뜻한 마음': "선덕여왕은 백성들을 위한 여러 가지 정책을 펼치며 따뜻한 마음으로 다스렸습니다.",
            '나라를 지키는 상징, 구층목탑': "선덕여왕은 나라를 지키기 위해 황룡사 구층목탑을 건립하여 신라의 번영과 안정을 기원했습니다.",
            '위기와 죽음': "선덕여왕은 재위 기간 동안 여러 가지 위기와 어려움을 겪었으며, 결국 647년에 세상을 떠났습니다.",
        }
        ahn_job_answer = {
            '독립을 위한 망명과 활동': "안중근은 독립을 위해 망명하여 여러 활동을 펼쳤습니다.",
            '일본의 압박과 을사늑약': "안중근은 일본의 압박과 을사늑약을 비판하며 독립운동에 헌신하였습니다.",
            '항일 의병 투쟁': "안중근은 항일 의병 투쟁을 통해 일본에 저항하였습니다.",
            '이토 히로부미 저격': "안중근은 1909년 하얼빈에서 이토 히로부미를 저격하여 한국의 독립 의지를 세계에 알렸습니다.",
            '의연한 재판과 순국': "안중근은 일본 법정에서 의연하게 자신의 뜻을 밝히고 1910년 순국하였습니다.",
        }
        // 스토리 정보
        sejong_story_list = ['초정 약수 이야기', '고기를 좋아하는 세종', '한글 창제']
        sunduk_story_list = [
            '향기 없는 꽃의 비밀',
            '개구리들의 비밀 신호',
            '마지막 예언']
        ahn_story_list = [
            '손가락의 단지',
            '하얼빈에서의 준비',
            '감옥에서의 교육 활동']
        // 스토리 답변
        sejong_story_answer = {
            '초정 약수 이야기': "세종대왕은 건강이 좋지 않았을 때 초정 약수를 마시며 요양을 하였고, 이 약수는 세종대왕의 병을 호전시키는 데 큰 역할을 했다고 전해집니다.",
            '고기를 좋아하는 세종': "세종대왕은 고기를 좋아했으며, 특히 소고기를 즐겨 먹었다고 합니다.",
            '한글 창제': "세종대왕은 백성들이 쉽게 읽고 쓸 수 있는 한글, 즉 훈민정음을 창제하였습니다. 이는 한국 역사상 가장 중요한 문화적 업적으로 평가되며, 오늘날까지도 사용되고 있는 한국어의 기초가 되었습니다."
        }
        sunduk_story_answer = {
            '향기 없는 꽃의 비밀': "선덕여왕은 향기 없는 꽃을 보고 자신의 운명을 예견했다고 전해집니다.",
            '개구리들의 비밀 신호': "선덕여왕은 개구리들의 울음소리를 듣고 적의 침입을 알아챘다는 이야기가 전해집니다.",
            '마지막 예언': "선덕여왕은 죽기 전, 자신의 무덤 자리를 예언하며 그곳에 묻히기를 원했다고 합니다."
        }
        ahn_story_answer = {
            '손가락의 단지': "안중근은 동지들과 함께 독립을 맹세하며 손가락을 자르는 결의를 하였습니다.",
            '하얼빈에서의 준비': "안중근은 하얼빈에서 이토 히로부미 저격을 위해 철저히 준비하였습니다.",
            '감옥에서의 교육 활동': "안중근은 감옥에서도 교육 활동을 멈추지 않고, 동료들에게 글을 가르치며 희망을 잃지 않았습니다."
        }

        // 유저 클릭시 응답
        function selectOptionByUser(message) {
            // 유저 클릭시 유저 메시지로 보내질 내용
            let newMessage = document.createElement("div");
            newMessage.className = "sent-message";
            newMessage.innerHTML = `
                <div class="sent-message-box">
                    <div class="message-text">${message}</div>
                </div>
                `;

            // 새로운 메시지를 chat-body에 추가
            let chatBody = document.getElementById("chat-body");
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        // npc 역할1
        function whatdoyouwanttoknow(character) {

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${character}의 무엇이 궁금해?
                        </div>
                    </div>
                </div>
                <!-- npc 채팅 옵션 -->
                <div class="npc-options rounded">
                    <div class="btn npc-option" onclick="selectOptionByUser('어떤 사람이었어?'); whatkindofperson('${character}');">
                        어떤 사람이었어?
                    </div>
                    <div class="btn npc-option" onclick="selectOptionByUser('무슨 일을 했어?'); whatjob('${character}');">
                        무슨 일을 했어?
                    </div>
                    <div class="btn npc-option" onclick="selectOptionByUser('재밌는 이야기 알려줘'); funstory('${character}');">
                        재밌는 이야기 알려줘
                    </div>
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;

        }

        // 유저 클릭시 npc 역할2
        function whatkindofperson(character) {
            let info = ''

            if (character === '세종대왕') {
                info = sejongInfo
            } else if (character === '선덕여왕') {
                info = sundukInfo
            } else if (character === '안중근') {
                info = ahnInfo
            }

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${info}
                        </div>
                    </div>
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }


        // 유저 클릭시 npc 역할3
        function whatjob(character) {

            let htmlString = ``;

            let job_list = []
            if (character === "세종대왕") {
                job_list = sejong_job_list
            } else if (character === "선덕여왕") {
                job_list = sunduk_job_list
            } else if (character === "안중근") {
                job_list = ahn_job_list
            }


            for (let job of job_list) {
                htmlString += `
                <div class="btn npc-option" onclick="selectOptionByUser('${job}'); jobInfo('${job}', '${character}');">
                    ${job}
                </div>
                `
            }

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${character}은 많은 업적이 있어! 어떤 업적을 알고 싶어?
                        </div>
                    </div>
                </div>
                <!-- npc 채팅 옵션 -->
                <div class="npc-options rounded">
                    ${htmlString}
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function jobInfo(job, character) {

            let job_list = []
            let job_answer = []

            if (character === "세종대왕") {
                job_list = sejong_job_list
                job_answer = sejong_job_answer
            } else if (character === "선덕여왕") {
                job_list = sunduk_job_list
                job_answer = sunduk_job_answer
            } else if (character === "안중근") {
                job_list = ahn_job_list
                job_answer = ahn_job_answer
            }

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${job_answer[`${job}`]}
                        </div>
                    </div>
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function funstory(character) {
            let story_list = []

            if (character === "세종대왕") {
                story_list = sejong_story_list
            } else if (character === "선덕여왕") {
                story_list = sunduk_story_list
            } else if (character === "안중근") {
                story_list = ahn_story_list
            }

            let htmlString = ``;

            for (let story of story_list) {
                htmlString += `
                <div class="btn npc-option" onclick="selectOptionByUser('${story}'); storyInfo('${story}', '${character}');">
                    ${story}
                </div>
                `
            }

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${character}의 재밌는 스토리는 많이 있어! 어느 것을 알고 싶어?
                        </div>
                    </div>
                </div>
                <!-- npc 채팅 옵션 -->
                <div class="npc-options rounded">
                    ${htmlString}
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function storyInfo(story, character) {

            let story_list = []
            let story_answer = []

            if (character === "세종대왕") {
                story_list = sejong_story_list
                story_answer = sejong_story_answer
            } else if (character === "선덕여왕") {
                story_list = sunduk_story_list
                story_answer = sunduk_story_answer
            } else if (character === "안중근") {
                story_list = ahn_story_list
                story_answer = ahn_story_answer
            }
            // let htmlString = "";

            // for (let story in story_list) {
            //     htmlString += `
            //     <div class="btn npc-option" onclick="selectOptionByUser('${story}'); storyInfo('${story}');">
            //         ${story}
            //     </div>
            //     `
            // }

            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${story_answer[`${story}`]}
                        </div>
                    </div>
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function knowmore(character) {
            let newMessage = document.createElement("div");
            newMessage.className = "npc";
            newMessage.innerHTML = `
                <div class="npc-message">
                    <img src="/static/owl.png" height="50px" alt="" />
                    <div class="npc-message-box">
                        <div class="message-sender">역사 천재</div>
                        <div class="message-text">${character}에 대해 더 알고 싶은 거 있어?
                        </div>
                    </div>
                </div>
                <!-- npc 채팅 옵션 -->
                <div class="npc-options rounded">
                    
                    <div class="btn npc-option" onclick="selectOptionByUser('유교정치')">
                        더 알고 싶어
                    </div>
                    <div class="btn npc-option" onclick="selectOptionByUser('집현전')">
                        없어
                    </div>
                </div>
            </div>
            `;

            // Get the chat body element where you want to append the new message
            let chatBody = document.getElementById("chat-body");

            // Append the new message to the chat body
            chatBody.appendChild(newMessage);

            // Scroll to the bottom of the chat body (optional)
            chatBody.scrollTop = chatBody.scrollHeight;
        }

    </script>
</body>

</html>